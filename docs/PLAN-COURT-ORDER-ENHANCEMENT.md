# Court Order Enhancement - Implementation Plan

## Overview
Enhance the Court Order section with:
1. **Admin Video Override** - Custom video upload for specific comparisons
2. **6-Tab Freedom Education** - Category-based winning metrics with real-world examples
3. **Hero Footer Statements** - Joyful summaries per category tab

---

## Part 1: Admin Video Upload Override

### Database
**New table: `court_order_video_overrides`**
- `id`, `city_name`, `comparison_id`, `video_url`, `thumbnail_url`, `uploaded_by`, `is_active`
- Check by comparison_id first (specific), then by city_name (generic fallback)

### Files to Create/Modify
| File | Action |
|------|--------|
| `supabase/migrations/20260203_court_order_overrides.sql` | CREATE table + RLS policies |
| `src/services/grokVideoService.ts` | ADD `checkCourtOrderOverride()` function |
| `src/hooks/useGrokVideo.ts` | MODIFY to check override BEFORE Grok generation |
| `src/types/grokVideo.ts` | ADD `CourtOrderVideoOverride` interface |

### Flow
```
User clicks "See Court Order"
    â†’ Check Supabase for override (by comparison_id, then city_name)
    â†’ IF override exists: Use admin video URL directly
    â†’ ELSE: Generate via Grok as normal
```

---

## Part 2: 6-Tab Freedom Education Section

### Data Strategy
- **Generate at report time** - Extend Judge Report API to include freedom examples
- **Cache in judgeReport.freedomEducation** - No additional API calls when viewing
- **Opus Judge generates** real-world examples per winning metric

### New Types
```typescript
interface FreedomExample {
  metricId: string;
  metricName: string;
  metricIcon: string;
  winnerScore: number;
  loserScore: number;
  realWorldExample: string;  // Generated by Opus
}

interface CategoryFreedomData {
  categoryId: CategoryId;
  categoryName: string;
  categoryIcon: string;
  winningMetrics: FreedomExample[];
  heroStatement: string;  // Generated by Opus
}
```

### Files to Create
| File | Purpose |
|------|---------|
| `src/types/freedomEducation.ts` | Type definitions |
| `src/components/FreedomCategoryTabs.tsx` | 6-tab navigation (Personal, Housing, Business, Transport, Policing, Speech) |
| `src/components/FreedomCategoryTabs.css` | Glassmorphic tab styling |
| `src/components/FreedomMetricsList.tsx` | Winning metrics display with bullet points |
| `src/components/FreedomMetricsList.css` | Glass card styling for metrics |
| `src/components/FreedomHeroFooter.tsx` | Hero statement footer per tab |
| `src/components/FreedomHeroFooter.css` | Glowing hero statement styling |
| `src/utils/freedomEducationUtils.ts` | Data transformation utilities |

### Files to Modify
| File | Changes |
|------|---------|
| `api/judge-report.ts` | Extend prompt to request freedom examples + hero statements |
| `src/components/JudgeTab.tsx` | Extend JudgeReport interface, pass freedomEducation to CourtOrderVideo |
| `src/components/CourtOrderVideo.tsx` | Add tabs, metrics list, hero footer ABOVE video |

---

## Part 3: UI Design

### Layout (Top to Bottom)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš–ï¸ COURT ORDER - Your Future in {winnerCity}                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ—½ Personal] [ğŸ  Housing] [ğŸ’¼ Business] [ğŸš‡ Transport] [âš–ï¸ Police] [ğŸ­ Speech] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚ â”‚ ğŸŒ¿ Cannabis Legality                          85 vs 40         â”‚ â”‚
â”‚ â”‚ ğŸ’¡ "You can legally purchase cannabis at dispensaries..."     â”‚ â”‚
â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â”‚ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â”‚
â”‚ â”‚ ğŸº Alcohol Sales                              90 vs 65         â”‚ â”‚
â”‚ â”‚ ğŸ’¡ "No blue laws restrict your Sunday beer runs..."          â”‚ â”‚
â”‚ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ¨ HERO STATEMENT                                                   â”‚
â”‚ "In {winnerCity}, personal autonomy flourishes..."                 â”‚
â”‚ ğŸ† {winnerCity} Advantage                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      [LCD VIDEO PLAYER]                            â”‚
â”‚                    (AI or Admin Override)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            [ğŸ’¾ SAVE] [â¬‡ï¸ DOWNLOAD] [ğŸ“¤ SHARE]                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Styling
- **Background:** Midnight navy (#0a1628) with cockpit blue panels (#0d2847)
- **Accents:** Brushed gold (#c9a227, #d4af37)
- **Glassmorphic:** `backdrop-filter: blur(20px)`, `rgba(13, 40, 71, 0.6)` background
- **Borders:** `1px solid rgba(201, 162, 39, 0.2)`
- **Active tab:** Gold underline, gold border, glowing shadow

---

## Implementation Sequence

**PRIORITY: Freedom Education Tabs First** (Admin Video Override deferred)

### Phase 1: Types (First)
1. Create `src/types/freedomEducation.ts`

### Phase 2: Freedom Education Components
1. Create `FreedomCategoryTabs.tsx` + CSS
2. Create `FreedomMetricsList.tsx` + CSS
3. Create `FreedomHeroFooter.tsx` + CSS
4. Create `freedomEducationUtils.ts`

### Phase 4: API Enhancement
1. Extend `api/judge-report.ts` prompt to request:
   - Winning metrics per category
   - Real-world examples for each
   - Hero statements per category
2. Extend JudgeReport interface in `JudgeTab.tsx`

### Phase 5: Integration
1. Modify `CourtOrderVideo.tsx`:
   - Add new props (loserCity, freedomEducation)
   - Add tabs section above video
   - Add category state management
2. Modify `JudgeTab.tsx`:
   - Pass new props to CourtOrderVideo
   - Transform freedomEducation data

---

## Verification Steps

1. **Admin Override Test:**
   - Insert test record in Supabase `court_order_video_overrides`
   - Trigger Court Order generation
   - Verify admin video displays instead of Grok

2. **Freedom Education Test:**
   - Run a comparison (e.g., Miami vs Dallas)
   - Generate Judge Report
   - Verify freedomEducation data in console
   - Click through all 6 tabs
   - Verify winning metrics display correctly
   - Verify hero statements render

3. **Mobile Responsiveness:**
   - Test tabs on 375px width
   - Verify metrics scroll properly
   - Verify hero footer is readable

---

## Critical Files Summary

| File | Action | Priority |
|------|--------|----------|
| `src/components/CourtOrderVideo.tsx` | MAJOR modification | High |
| `api/judge-report.ts` | Extend prompt | High |
| `src/components/JudgeTab.tsx` | Pass new props | High |
| `src/hooks/useGrokVideo.ts` | Add override check | Medium |
| `src/types/freedomEducation.ts` | NEW | High |
| `src/components/FreedomCategoryTabs.tsx` | NEW | High |
| `src/components/FreedomMetricsList.tsx` | NEW | High |
| `src/components/FreedomHeroFooter.tsx` | NEW | High |
